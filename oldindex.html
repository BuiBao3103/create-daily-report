<!DOCTYPE html>
<html lang="vi" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Báo Cáo Hàng Ngày</title>

    <!-- Favicon -->
    <link
      rel="icon"
      href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMjE5NkYzIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0Ij48cGF0aCBkPSJNMTQgM3Y0YTEgMSAwIDAgMCAxIDFoNE0xNyAyMXYtMmEyIDIgMCAwIDAtMi0ySDkgYTIgMiAwIDAgMC0yIDJ2Mk03IDExdjgiPjwvcGF0aD48cmVjdCB4PSIzIiB5PSIxMSIgd2lkdGg9IjUiIGhlaWdodD0iNSIgcng9IjEiPjwvcmVjdD48cGF0aCBkPSJNMTggMmgtOGExIDEgMCAwIDAtMSAxdjEzYTEgMSAwIDAgMCAxIDFoMTBhMSAxIDAgMCAwIDEtMVY1TDE4IDJ6Ij48L3BhdGg+PC9zdmc+"
      type="image/svg+xml" />

    <style>
      :root {
        /* Dark theme variables */
        --dark-bg-primary: #121212;
        --dark-bg-secondary: #1e1e1e;
        --dark-accent: #2196f3;
        --dark-accent-hover: #1976d2;
        --dark-text-primary: #e0e0e0;
        --dark-text-secondary: #a0a0a0;
        --dark-success: #4caf50;
        --dark-border: rgba(255, 255, 255, 0.1);
        --dark-gradient: linear-gradient(135deg, #263238, #0d1821);

        /* Light theme variables */
        --light-bg-primary: #ffffff;
        --light-bg-secondary: #f5f5f5;
        --light-accent: #2196f3;
        --light-accent-hover: #1976d2;
        --light-text-primary: #212121;
        --light-text-secondary: #757575;
        --light-success: #4caf50;
        --light-border: rgba(0, 0, 0, 0.1);
        --light-gradient: linear-gradient(135deg, #e0e0e0, #f5f5f5);

        /* Common variables */
        --border-radius: 10px;
        --box-shadow-dark: 0 4px 10px rgba(0, 0, 0, 0.3);
        --box-shadow-light: 0 4px 10px rgba(0, 0, 0, 0.1);
      }

      html[data-theme="dark"] {
        --bg-primary: var(--dark-bg-primary);
        --bg-secondary: var(--dark-bg-secondary);
        --accent: var(--dark-accent);
        --accent-hover: var(--dark-accent-hover);
        --text-primary: var(--dark-text-primary);
        --text-secondary: var(--dark-text-secondary);
        --success: var(--dark-success);
        --border: var(--dark-border);
        --gradient: var(--dark-gradient);
        --box-shadow: var(--box-shadow-dark);
      }

      html[data-theme="light"] {
        --bg-primary: var(--light-bg-primary);
        --bg-secondary: var(--light-bg-secondary);
        --accent: var(--light-accent);
        --accent-hover: var(--light-accent-hover);
        --text-primary: var(--light-text-primary);
        --text-secondary: var(--light-text-secondary);
        --success: var(--light-success);
        --border: var(--light-border);
        --gradient: var(--light-gradient);
        --box-shadow: var(--box-shadow-light);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        transition: all 0.2s ease;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: var(--gradient);
        color: var(--text-primary);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 15px;
      }

      .container {
        width: 100%;
        max-width: 900px;
        background: var(--bg-primary);
        border-radius: var(--border-radius);
        box-shadow: var(--box-shadow);
        overflow: hidden;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 0;
        height: calc(100vh - 30px);
        max-height: 700px;
      }

      .input-section,
      .output-section {
        padding: 20px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
      }

      .output-section {
        background: var(--bg-secondary);
        border-left: 1px solid var(--border);
        position: relative;
      }

      h2 {
        color: var(--accent);
        margin-bottom: 15px;
        font-size: 1.4rem;
        font-weight: 600;
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }

      .form-group {
        margin-bottom: 12px;
      }

      .custom-label-group {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 4px;
      }

      .custom-label-btn {
        background: transparent;
        color: var(--text-secondary);
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 12px;
        border: 1px solid var(--border);
        cursor: pointer;
      }

      .custom-label-btn:hover {
        background: rgba(128, 128, 128, 0.1);
        color: var(--text-primary);
      }

      label {
        display: block;
        margin-bottom: 5px;
        color: var(--text-secondary);
        font-weight: 500;
        font-size: 0.9rem;
      }

      input,
      textarea {
        width: 100%;
        padding: 10px 12px;
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: var(--border-radius);
        color: var(--text-primary);
        font-size: 14px;
        outline: none;
      }

      textarea {
        height: 90px;
        resize: none;
        line-height: 1.5;
      }

      input:focus,
      textarea:focus {
        border-color: var(--accent);
        box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.25);
      }

      button {
        padding: 10px 15px;
        border: none;
        border-radius: var(--border-radius);
        font-weight: 600;
        cursor: pointer;
        font-size: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .btn-primary {
        background: var(--accent);
        color: white;
        width: 100%;
        margin-top: auto;
      }

      .btn-primary:hover {
        background: var(--accent-hover);
      }

      .btn-icon {
        background: transparent;
        color: var(--text-secondary);
        padding: 5px;
        border-radius: 50%;
        position: absolute;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2;
      }

      .btn-icon:hover {
        background: rgba(128, 128, 128, 0.1);
        color: var(--text-primary);
      }

      .copy-btn {
        top: 15px;
        right: 15px;
      }

      .theme-toggle {
        position: absolute;
        top: 15px;
        right: 15px;
        z-index: 100;
      }

      .theme-toggle .btn-icon {
        position: static;
      }

      .output-container {
        position: relative;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        margin-top: 10px;
      }

      .output {
        background: var(--bg-primary);
        padding: 20px;
        border-radius: var(--border-radius);
        font-family: "Consolas", "Courier New", monospace;
        white-space: pre-wrap;
        color: var(--text-primary);
        border: 1px solid var(--border);
        overflow-y: auto;
        line-height: 1.5;
        flex-grow: 1;
        position: relative;
      }

      .logo-icon {
        width: 24px;
        height: 24px;
      }

      /* Mobile responsive */
      @media screen and (max-width: 768px) {
        .container {
          grid-template-columns: 1fr;
          height: auto;
          max-height: none;
        }

        .output-section {
          border-left: none;
          border-top: 1px solid var(--border);
        }

        .input-section,
        .output-section {
          height: auto;
          padding: 15px;
        }

        textarea {
          height: 70px;
        }

        .theme-toggle {
          top: 10px;
          right: 10px;
        }
      }

      /* Success message */
      .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 12px 15px;
        border-radius: var(--border-radius);
        background: var(--success);
        color: white;
        box-shadow: var(--box-shadow);
        transform: translateX(200%);
        transition: transform 0.3s ease;
        z-index: 1000;
        font-size: 14px;
      }

      .notification.show {
        transform: translateX(0);
      }

      .task-list .task-row {
        display: flex;
        gap: 8px;
        margin-bottom: 8px;
        align-items: center;
      }

      .task-row input[type="text"] {
        flex: 1;
      }

      .task-row input[type="number"] {
        width: 60px;
      }

      .task-row .remove-btn {
        background: #ff5252;
        color: white;
        border: none;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="theme-toggle">
      <button class="btn-icon" onclick="toggleTheme()" title="Chuyển đổi giao diện sáng/tối">
        <svg
          id="theme-icon"
          xmlns="http://www.w3.org/2000/svg"
          width="18"
          height="18"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
      </button>
    </div>

    <div class="container">
      <div class="input-section">
        <h2>
          <svg
            class="logo-icon"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round">
            <path d="M14 3v4a1 1 0 0 0 1 1h4M17 21v-2a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v2M7 11v8"></path>
            <rect x="3" y="11" width="5" height="5" rx="1"></rect>
            <path d="M18 2h-8a1 1 0 0 0-1 1v13a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V5L18 2z"></path>
          </svg>
          Nhập Báo Cáo
        </h2>
        <div class="form-group">
          <label for="name">Tên:</label>
          <input type="text" id="name" placeholder="Nhập tên của bạn..." />
        </div>

        <div class="form-group">
          <label for="date">Ngày:</label>
          <input type="date" id="date" />
        </div>

        <div class="form-group">
          <div class="custom-label-group">
            <label for="yesterdayLabel">Nhãn 1:</label>
            <button class="custom-label-btn" onclick="resetLabel('yesterdayLabel')">Mặc định</button>
          </div>
          <input type="text" id="yesterdayLabel" placeholder="Nhập nhãn tùy chỉnh..." value="Hôm qua" />
        </div>

        <div class="form-group">
          <label for="yesterday">Nội dung 1:</label>
          <div id="yesterdayTasks" class="task-list"></div>
          <button type="button" class="custom-label-btn" onclick="addTaskRow('yesterdayTasks')">+ Thêm dòng</button>
        </div>

        <div class="form-group">
          <div class="custom-label-group">
            <label for="todayLabel">Nhãn 2:</label>
            <button class="custom-label-btn" onclick="resetLabel('todayLabel')">Mặc định</button>
          </div>
          <input type="text" id="todayLabel" placeholder="Nhập nhãn tùy chỉnh..." value="Hôm nay" />
        </div>

        <div class="form-group">
          <label for="today">Nội dung 2:</label>
          <div id="todayTasks" class="task-list"></div>
          <button type="button" class="custom-label-btn" onclick="addTaskRow('todayTasks')">+ Thêm dòng</button>
        </div>

        <button class="btn-primary" onclick="generateReport()">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            style="margin-right: 8px">
            <path d="M12 5v14M5 12h14" />
          </svg>
          Tạo báo cáo
        </button>
      </div>

      <div class="output-section">
        <h2>
          <svg
            class="logo-icon"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round">
            <path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"></path>
            <line x1="16" y1="8" x2="2" y2="22"></line>
            <line x1="17.5" y1="15" x2="9" y2="15"></line>
          </svg>
          Báo Cáo Của Bạn
        </h2>
        <div class="output-container">
          <button class="btn-icon copy-btn" onclick="copyToClipboard()" title="Sao chép báo cáo">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
            </svg>
          </button>
          <div class="output" id="outputText">
            Báo cáo sẽ hiển thị ở đây sau khi bạn nhập thông tin và nhấn "Tạo báo cáo".
          </div>
        </div>
      </div>
    </div>

    <div class="notification" id="notification">Đã sao chép báo cáo vào clipboard!</div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        document.getElementById("date").valueAsDate = new Date();
        updateThemeIcon();

        // Khôi phục các nhãn từ localStorage nếu có
        const savedYesterdayLabel = localStorage.getItem("yesterdayLabel");
        if (savedYesterdayLabel) {
          document.getElementById("yesterdayLabel").value = savedYesterdayLabel;
        }

        const savedTodayLabel = localStorage.getItem("todayLabel");
        if (savedTodayLabel) {
          document.getElementById("todayLabel").value = savedTodayLabel;
        }
      });

      function resetLabel(labelId) {
        if (labelId === "yesterdayLabel") {
          document.getElementById(labelId).value = "Hôm qua";
          localStorage.setItem("yesterdayLabel", "Hôm qua");
        } else if (labelId === "todayLabel") {
          document.getElementById(labelId).value = "Hôm nay";
          localStorage.setItem("todayLabel", "Hôm nay");
        }
      }

      function addTaskRow(containerId) {
        const container = document.getElementById(containerId);

        const row = document.createElement("div");
        row.className = "task-row";

        const taskInput = document.createElement("input");
        taskInput.type = "text";
        taskInput.placeholder = "Nhập công việc...";
        taskInput.className = "task-desc";

        const hourInput = document.createElement("input");
        hourInput.type = "number";
        hourInput.placeholder = "Giờ";
        hourInput.min = "0";
        hourInput.step = "0.5";
        hourInput.className = "task-hour";

        const removeBtn = document.createElement("button");
        removeBtn.innerText = "X";
        removeBtn.className = "remove-btn";
        removeBtn.onclick = () => row.remove();

        row.appendChild(taskInput);
        row.appendChild(hourInput);
        row.appendChild(removeBtn);

        container.appendChild(row);
      }

      function collectTasks(containerId) {
        const container = document.getElementById(containerId);
        const rows = container.querySelectorAll(".task-row");
        if (rows.length === 0) return "    + Không có";

        return Array.from(rows)
          .map((row) => {
            const desc = row.querySelector(".task-desc")?.value.trim();
            const hour = row.querySelector(".task-hour")?.value.trim();
            if (!desc) return null;
            return `    + ${desc}${hour ? " " + hour + "h" : ""}`;
          })
          .filter(Boolean)
          .join("\n");
      }

      function generateReport() {
        const name = document.getElementById("name").value.trim();
        const date = document.getElementById("date").value;
        const yesterdayLabel = document.getElementById("yesterdayLabel").value.trim() || "Hôm qua";
        const todayLabel = document.getElementById("todayLabel").value.trim() || "Hôm nay";
        const yesterday = document.getElementById("yesterday").value.trim();
        const today = document.getElementById("today").value.trim();

        // Lưu các nhãn tùy chỉnh vào localStorage để sử dụng sau này
        localStorage.setItem("yesterdayLabel", yesterdayLabel);
        localStorage.setItem("todayLabel", todayLabel);

        const formatLines = (text) => {
          if (!text) return "    + Không có";

          // Xử lý từng dòng để đảm bảo mỗi dòng bắt đầu bằng "+"
          return text
            .split("\n")
            .filter((line) => line.trim() !== "")
            .map((line) => {
              line = line.trim();
              // Nếu dòng đã có "+" ở đầu, chỉ thêm khoảng trắng
              if (line.startsWith("+")) {
                return `    ${line}`;
              }
              // Nếu không, thêm cả "+" và khoảng trắng
              return `    + ${line}`;
            })
            .join("\n");
        };

        let formattedDate = "";
        if (date) {
          const dateObj = new Date(date);
          formattedDate = dateObj.toLocaleDateString("vi-VN", { day: "2-digit", month: "2-digit", year: "numeric" });
        }

        let output = ``;
        output += `${name || "[Chưa nhập tên]"}\n`;
        output += `Daily (${formattedDate || "[Chưa chọn ngày]"})\n`;
        output += `# ${yesterdayLabel}\n`;
        output += `${collectTasks("yesterdayTasks")}\n`;
        output += `# ${todayLabel}\n`;
        output += `${collectTasks("todayTasks")}\n`;

        document.getElementById("outputText").innerText = output;
      }

      function copyToClipboard() {
        const output = document.getElementById("outputText").innerText;
        if (output.includes("Báo cáo sẽ hiển thị ở đây")) {
          alert("Vui lòng tạo báo cáo trước khi sao chép!");
          return;
        }

        navigator.clipboard.writeText(output).then(
          function () {
            showNotification("Đã sao chép báo cáo vào clipboard!");
          },
          function (err) {
            console.error("Không thể sao chép: ", err);
            alert("Không thể sao chép báo cáo. Vui lòng thử lại sau.");
          }
        );
      }

      function showNotification(message) {
        const notification = document.getElementById("notification");
        notification.innerText = message;
        notification.classList.add("show");

        setTimeout(() => {
          notification.classList.remove("show");
        }, 2000);
      }

      function toggleTheme() {
        const html = document.documentElement;
        const currentTheme = html.getAttribute("data-theme");
        const newTheme = currentTheme === "dark" ? "light" : "dark";

        html.setAttribute("data-theme", newTheme);
        localStorage.setItem("theme", newTheme);

        updateThemeIcon();
      }

      function updateThemeIcon() {
        const currentTheme = document.documentElement.getAttribute("data-theme");
        const themeIcon = document.getElementById("theme-icon");

        if (currentTheme === "dark") {
          // Hiển thị biểu tượng mặt trời cho chế độ sáng
          themeIcon.innerHTML =
            '<circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>';
        } else {
          // Hiển thị biểu tượng mặt trăng cho chế độ tối
          themeIcon.innerHTML = '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>';
        }
      }

      // Khôi phục theme từ localStorage nếu có
      const savedTheme = localStorage.getItem("theme");
      if (savedTheme) {
        document.documentElement.setAttribute("data-theme", savedTheme);
        updateThemeIcon();
      }
      function addTaskRow(containerId) {
        const container = document.getElementById(containerId);

        const row = document.createElement("div");
        row.className = "task-row";

        const taskInput = document.createElement("input");
        taskInput.type = "text";
        taskInput.placeholder = "Nhập công việc...";
        taskInput.className = "task-desc";

        const hourInput = document.createElement("input");
        hourInput.type = "number";
        hourInput.placeholder = "Giờ";
        hourInput.min = "0";
        hourInput.step = "0.5";
        hourInput.className = "task-hour";

        const removeBtn = document.createElement("button");
        removeBtn.innerText = "X";
        removeBtn.className = "remove-btn";
        removeBtn.onclick = () => row.remove();

        row.appendChild(taskInput);
        row.appendChild(hourInput);
        row.appendChild(removeBtn);

        container.appendChild(row);
      }

      function collectTasks(containerId) {
        const container = document.getElementById(containerId);
        const rows = container.querySelectorAll(".task-row");
        if (rows.length === 0) return "    + Không có";

        return Array.from(rows)
          .map((row) => {
            const desc = row.querySelector(".task-desc")?.value.trim();
            const hour = row.querySelector(".task-hour")?.value.trim();
            if (!desc) return null;
            return `    + ${desc}${hour ? " " + hour + "h" : ""}`;
          })
          .filter(Boolean)
          .join("\n");
      }

      function generateReport() {
        const name = document.getElementById("name").value.trim();
        const date = document.getElementById("date").value;
        const yesterdayLabel = document.getElementById("yesterdayLabel").value.trim() || "Hôm qua";
        const todayLabel = document.getElementById("todayLabel").value.trim() || "Hôm nay";

        // Save labels
        localStorage.setItem("yesterdayLabel", yesterdayLabel);
        localStorage.setItem("todayLabel", todayLabel);

        const formatDate = (d) => {
          if (!d) return "[Chưa chọn ngày]";
          const dateObj = new Date(d);
          return dateObj.toLocaleDateString("vi-VN", { day: "2-digit", month: "2-digit", year: "numeric" });
        };

        const output = `${name || "[Chưa nhập tên]"}
Daily (${formatDate(date)})
# ${yesterdayLabel}
${collectTasks("yesterdayTasks")}
# ${todayLabel}
${collectTasks("todayTasks")}
`;

        document.getElementById("outputText").innerText = output;
      }
    </script>
  </body>
</html>
